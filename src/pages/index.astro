---
import { Image } from "astro:assets";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import BlueskyFeed from "../components/BlueskyFeed.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import { getCollection } from "astro:content";
import eidolwareLogo from "../assets/logos/eidolware_logo.png";
import annaSide from "../assets/characters/anna-side.png";
import susieSide from "../assets/characters/susie-side.png";

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <Header />
    <main class="home-main">
      <section class="hero">
        <div class="hero-bg">
          <div class="hero-grid"></div>
          <div class="glow glow-pink"></div>
          <div class="glow glow-cyan"></div>
          <div class="scanlines"></div>
        </div>

        <div class="hero-inner">
          <div class="hero-top-bar">
            <span class="bar-label">FATBAT Studio //</span>
            <span class="bar-jp">ファットバット</span>
            <span class="bar-status">
              <span class="pulse"></span>
              ACTIVE DEV
            </span>
          </div>

          <div class="hero-center">
            <h1 class="logo-wrap">
              <Image
                src={eidolwareLogo}
                alt="EIDOLWARE"
                width={1200}
                height={257}
                class="logo"
                loading="eager"
                decoding="async"
              />
            </h1>
            <div class="tagline">
              <div class="tag-line"></div>
              <span class="tag-text">Cyberpunk Anime Convention Action-RPG</span
              >
              <div class="tag-line"></div>
            </div>
          </div>

          <p class="desc">{SITE_DESCRIPTION}</p>

          <div class="cta-row">
            <a
              href="https://fatbatstudio.itch.io/eidolware"
              target="_blank"
              rel="noopener noreferrer"
              class="btn btn-pink">Follow on itch.io</a
            >
            <a href="#" class="btn btn-ghost" title="Coming Soon"
              >Steam — Coming Soon</a
            >
            <a href="/blog" class="btn btn-cyan">Devlog</a>
          </div>
        </div>

        <div class="hero-stripe">
          <div class="stripe-pink"></div>
          <div class="stripe-cyan"></div>
        </div>
      </section>

      <!-- Story -->
      <div class="story-banner">
        <div class="banner-art">
          <Image
            src={annaSide}
            alt="Anna Lam"
            width={800}
            height={500}
            class="banner-art-img"
            loading="lazy"
          />
        </div>
        <div class="banner-head">
          <div class="num-block num-pink">
            <span class="num">01</span>
          </div>
          <div class="head-text">
            <span class="head-jp">物語</span>
            <h2 class="head-title">The Story</h2>
          </div>
        </div>
      </div>

      <section class="story story-no-head">
        <div class="story-grid">
          <div class="story-card card-lead">
            <div class="card-edge edge-pink"></div>
            <p>
              Infiltrate a 24/7 anime convention where holograms are real,
              influencers reign supreme, and Otaku culture has gone completely
              off the rails in this satirical cyberpunk action-RPG by FATBAT
              Studio.
            </p>
          </div>
          <div class="story-card">
            <div class="card-edge edge-cyan"></div>
            <p>
              You are Anna Lam, a former AI engineer. The mysterious death of
              your mentor has led you to a newly established 24-hour anime
              convention, owned and operated by a crypto-billionaire who styles
              himself "Fedora Mask".
            </p>
          </div>
          <div class="story-card">
            <div class="card-edge edge-pink"></div>
            <p>
              Immerse yourself in the convention and meet its strange denizens.
              Team up with unlikely allies to defeat Fedora Mask's lieutenants
              and gain access to the convention's inner circle. Uncover the
              truth behind your mentor's death and if anyone is responsible, put
              an end to their plans.
            </p>
          </div>
        </div>
        <div class="story-stripe">
          <div class="stripe-pink"></div>
          <div class="stripe-cyan"></div>
        </div>
      </section>

      <!-- Features -->
      <div class="features-banner">
        <div class="banner-art">
          <Image
            src={susieSide}
            alt="Susie"
            width={800}
            height={500}
            class="banner-art-img"
            loading="lazy"
          />
        </div>
        <div class="banner-head">
          <div class="num-block num-cyan">
            <span class="num">02</span>
          </div>
          <div class="head-text">
            <span class="head-jp">フェドラコンが待つ</span>
            <h2 class="head-title">FedoraCon Awaits</h2>
          </div>
        </div>
      </div>

      <section class="features features-no-head">
        <div class="feature-grid">
          <div class="feature">
            <div class="card-edge edge-pink"></div>
            <div class="feature-idx">
              <span class="idx-num">A</span>
              <div class="idx-line"></div>
            </div>
            <h3>Underground Convention</h3>
            <p>
              Enter FedoraCon, a 24/7 anime convention in an underground bunker,
              powered by holographic technology and funded by a
              crypto-billionaire's dream of making anime real.
            </p>
          </div>
          <div class="feature">
            <div class="card-edge edge-cyan"></div>
            <div class="feature-idx">
              <span class="idx-num">B</span>
              <div class="idx-line"></div>
            </div>
            <h3>Distinct Wings</h3>
            <p>
              Explore themed convention wings: an artist alley that turns into a
              haunted forest, a ballroom dance-off maze, a cosplay battle
              royale, and secret areas, each run by a lieutenant with their own
              rules.
            </p>
          </div>
          <div class="feature">
            <div class="card-edge edge-pink"></div>
            <div class="feature-idx">
              <span class="idx-num">C</span>
              <div class="idx-line"></div>
            </div>
            <h3>Eccentric Cast</h3>
            <p>
              A Halloween obsessive lifestylist, a K-Pop star who only speaks
              through dance, a corporate-sponsored kawaii influencer, a
              conspirophile vinyl figure collector, and a masked billionaire who
              thinks he's a Level 20 Paladin.
            </p>
          </div>
        </div>
      </section>

      <BlueskyFeed />

      {
        posts.length > 0 && (
          <section class="devlog">
            <div class="section-head">
              <div class="num-block num-pink">
                <span class="num">04</span>
              </div>
              <div class="head-text">
                <span class="head-jp">開発日記</span>
                <h2 class="head-title">Devlog</h2>
              </div>
              <div class="head-rule" />
              <a href="/blog" class="devlog-all">
                All Posts →
              </a>
            </div>
            <div class="devlog-grid">
              {posts.map((post, i) => (
                <article class="devlog-card">
                  <a href={`/blog/${post.id}/`} class="devlog-link">
                    <div
                      class="card-top-stripe"
                      style={`background: ${i % 2 === 0 ? "#e8157a" : "#00e5c3"}`}
                    />
                    <time>
                      {post.data.pubDate.toLocaleDateString("en-US", {
                        year: "numeric",
                        month: "short",
                        day: "numeric",
                      })}
                    </time>
                    <h3>{post.data.title}</h3>
                    <p>{post.data.description}</p>
                  </a>
                </article>
              ))}
            </div>
          </section>
        )
      }
    </main>
    <Footer />
  </body>
</html>

<style>
  .home-main {
    max-width: 100%;
    padding: 0;
    margin: 0;
  }

  /* ═══ HERO ═══ */
  .hero {
    position: relative;
    width: 100%;
    padding: 3rem 3rem 0;
    overflow: hidden;
  }

  .hero-bg {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .hero-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(232, 21, 122, 0.06) 1px, transparent 1px),
      linear-gradient(90deg, rgba(232, 21, 122, 0.06) 1px, transparent 1px);
    background-size: 60px 60px;
    mask-image: radial-gradient(
      ellipse 80% 70% at 50% 40%,
      black 20%,
      transparent 70%
    );
  }

  .glow {
    position: absolute;
    border-radius: 50%;
    filter: blur(140px);
    opacity: 0.12;
  }

  .glow-pink {
    width: 600px;
    height: 600px;
    background: #e8157a;
    top: -30%;
    left: 10%;
  }

  .glow-cyan {
    width: 450px;
    height: 450px;
    background: #00e5c3;
    bottom: -20%;
    right: 5%;
  }

  .scanlines {
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(255, 255, 255, 0.008) 2px,
      rgba(255, 255, 255, 0.008) 4px
    );
    pointer-events: none;
  }

  .hero-inner {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding-bottom: 3rem;
  }

  .hero-top-bar {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2.5rem;
    padding: 0.5rem 1.5rem;
    border: 1px solid #1a1a28;
    width: fit-content;
  }

  .bar-label {
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.75rem;
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: #e8157a;
  }

  .bar-jp {
    font-family: "Noto Sans JP", sans-serif;
    font-size: 0.78rem;
    font-weight: 700;
    color: #00e5c3;
    letter-spacing: 0.15em;
  }

  .bar-status {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.7rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: #8585a0;
  }

  .pulse {
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: #00e5c3;
    animation: pulse-anim 2s infinite;
  }

  @keyframes pulse-anim {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.2;
    }
  }

  .hero-center {
    margin-bottom: 2rem;
  }

  .logo-wrap {
    margin: 0 0 1.5rem;
    text-shadow: none;
    display: flex;
    justify-content: center;
  }

  .logo {
    width: 100%;
    max-width: 900px;
    height: auto;
    filter: brightness(1.4) contrast(1.1) saturate(0.9);
    transition: filter 0.3s ease;
  }

  .logo:hover {
    filter: brightness(1.8) contrast(1.2) saturate(1.1);
  }

  .tagline {
    display: flex;
    align-items: center;
    gap: 1.25rem;
    justify-content: center;
  }

  .tag-line {
    height: 1px;
    width: 60px;
    background: linear-gradient(90deg, transparent, #e8157a);
  }

  .tag-line:last-child {
    background: linear-gradient(90deg, #00e5c3, transparent);
  }

  .tag-text {
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.78rem;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: #9090a0;
  }

  .desc {
    font-family: "IBM Plex Mono", monospace;
    font-size: 1.05rem;
    line-height: 1.8;
    color: #a0a0a8;
    max-width: 680px;
    margin-bottom: 2.5rem;
  }

  .cta-row {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
    justify-content: center;
  }

  .btn {
    padding: 0.875rem 2rem;
    font-family: "Bebas Neue", sans-serif;
    font-size: 1.1rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    text-decoration: none;
    text-align: center;
    transition: all 0.15s ease;
    border: 2px solid;
  }

  .btn-pink {
    background: #e8157a;
    border-color: #e8157a;
    color: #fff;
  }

  .btn-pink:hover {
    background: #ff2090;
    border-color: #ff2090;
    box-shadow: 0 0 30px rgba(232, 21, 122, 0.4);
    color: #fff;
  }

  .btn-ghost {
    background: transparent;
    border-color: #333;
    color: #8585a0;
  }

  .btn-ghost:hover {
    border-color: #8585a0;
    color: #a0a0a8;
  }

  .btn-cyan {
    background: transparent;
    border-color: #00e5c3;
    color: #00e5c3;
  }

  .btn-cyan:hover {
    background: rgba(0, 229, 195, 0.08);
    box-shadow: 0 0 25px rgba(0, 229, 195, 0.25);
    color: #00e5c3;
  }

  .hero-stripe {
    display: flex;
    height: 3px;
    margin-left: -3rem;
    margin-right: -3rem;
  }

  .stripe-pink {
    flex: 1;
    background: #e8157a;
  }
  .stripe-cyan {
    flex: 1;
    background: #00e5c3;
  }

  /* ═══ STORY BANNER ═══ */
  .story-banner {
    position: relative;
    max-width: 1400px;
    margin: 0 auto;
    overflow: hidden;
  }

  .banner-head {
    display: flex;
    align-items: center;
    gap: 1.25rem;
    position: relative;
    z-index: 2;
    padding: 3.5rem 3rem;
  }

  .banner-art {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    height: 180%;
    z-index: 1;
    pointer-events: none;
    mask-image: linear-gradient(90deg, black 0%, black 60%, transparent 95%);
  }

  .banner-art-img {
    height: 100%;
    width: auto;
    object-fit: contain;
    filter: brightness(0.55) saturate(1.1);
  }

  .story-no-head {
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    border-bottom: none !important;
  }

  .story-stripe {
    display: flex;
    height: 3px;
    margin-top: 4rem;
  }

  /* ═══ FEATURES BANNER ═══ */
  .features-banner {
    position: relative;
    max-width: 1400px;
    margin: 0 auto;
    overflow: hidden;
  }

  .features-no-head {
    padding-top: 0 !important;
  }

  @media (max-width: 720px) {
    .banner-head {
      padding: 2rem 1.25rem;
    }

    .banner-art {
      height: 130%;
      opacity: 0.4;
    }
  }

  /* ═══ SECTIONS ═══ */
  .story,
  .features,
  .devlog {
    max-width: 1400px;
    margin: 0 auto;
    padding: 4rem 3rem;
    border-bottom: 1px solid #12121e;
  }

  .devlog {
    border-bottom: none;
  }

  .section-head {
    display: flex;
    align-items: center;
    gap: 1.25rem;
    margin-bottom: 3rem;
  }

  .num-block {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid;
    flex-shrink: 0;
  }

  .num-pink {
    border-color: #e8157a;
  }
  .num-cyan {
    border-color: #00e5c3;
  }

  .num {
    font-family: "Bebas Neue", sans-serif;
    font-size: 1.8rem;
    color: #fff;
    line-height: 1;
  }

  .head-text {
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
  }

  .head-jp {
    font-family: "Noto Sans JP", sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    color: #00e5c3;
    letter-spacing: 0.2em;
  }

  .head-title {
    font-family: "Bebas Neue", sans-serif;
    font-size: 2.2rem;
    letter-spacing: 0.08em;
    color: #fff;
    margin: 0;
    text-shadow: none;
    text-transform: uppercase;
  }

  .head-rule {
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, #1a1a28, transparent);
  }

  /* Story grid */
  .story-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: #1a1a28;
  }

  .story-card {
    background: #0a0a14;
    padding: 2rem;
    position: relative;
  }

  .card-edge {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
  }

  .edge-pink {
    background: #e8157a;
  }
  .edge-cyan {
    background: #00e5c3;
  }

  .story-card p {
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.95rem;
    line-height: 1.8;
    color: #9a9aa2;
    margin: 0;
  }

  .card-lead p {
    font-size: 1.05rem;
    color: #b8b8c0;
    font-weight: 500;
  }

  /* Features */
  .feature-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: #1a1a28;
  }

  .feature {
    background: #0a0a14;
    padding: 2rem;
    position: relative;
  }

  .feature-idx {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.25rem;
  }

  .idx-num {
    font-family: "Bebas Neue", sans-serif;
    font-size: 2rem;
    color: #e8157a;
    line-height: 1;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #e8157a;
  }

  .idx-line {
    flex: 1;
    height: 1px;
    background: #1a1a28;
  }

  .feature h3 {
    font-family: "Bebas Neue", sans-serif;
    font-size: 1.6rem;
    letter-spacing: 0.06em;
    color: #fff;
    margin-bottom: 0.5rem;
    text-shadow: none;
    text-transform: uppercase;
  }

  .feature p {
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.92rem;
    line-height: 1.75;
    color: #9090a0;
    margin: 0;
  }

  /* Devlog */
  .devlog-all {
    margin-left: auto;
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.78rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    text-decoration: none;
    color: #e8157a;
    border: 1px solid #e8157a;
    padding: 0.4rem 1rem;
    transition: all 0.15s ease;
    flex-shrink: 0;
  }

  .devlog-all:hover {
    background: #e8157a;
    color: #fff;
  }

  .devlog-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1px;
    background: #1a1a28;
  }

  .devlog-card {
    background: #0a0a14;
    transition: background 0.2s ease;
  }

  .devlog-card:hover {
    background: #0e0e1a;
  }

  .devlog-link {
    display: block;
    padding: 2rem;
    text-decoration: none;
    color: inherit;
  }

  .card-top-stripe {
    width: 100%;
    height: 2px;
    margin-bottom: 1.25rem;
  }

  .devlog-card time {
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.78rem;
    letter-spacing: 0.1em;
    color: #8585a0;
    display: block;
    margin-bottom: 0.75rem;
  }

  .devlog-card h3 {
    font-family: "Bebas Neue", sans-serif;
    font-size: 1.5rem;
    letter-spacing: 0.05em;
    color: #fff;
    margin-bottom: 0.5rem;
    text-shadow: none;
    text-transform: uppercase;
  }

  .devlog-card p {
    font-family: "IBM Plex Mono", monospace;
    font-size: 0.88rem;
    line-height: 1.65;
    color: #9090a0;
    margin: 0;
  }

  /* ═══ RESPONSIVE ═══ */
  @media (max-width: 1024px) {
    .story-grid {
      grid-template-columns: 1fr;
    }
    .feature-grid {
      grid-template-columns: 1fr;
    }
    .devlog-grid {
      grid-template-columns: 1fr;
    }
    .hero-top-bar {
      flex-wrap: wrap;
      justify-content: center;
    }
  }

  @media (max-width: 720px) {
    .hero {
      padding: 2rem 1.25rem 0;
    }
    .hero-stripe {
      margin-left: -1.25rem;
      margin-right: -1.25rem;
    }
    .story,
    .features,
    .devlog {
      padding: 2.5rem 1.25rem;
    }
    .head-title {
      font-size: 1.6rem;
    }
    .section-head {
      flex-wrap: wrap;
      gap: 0.75rem;
    }
    .cta-row {
      flex-direction: column;
      width: 100%;
    }
    .btn {
      width: 100%;
    }
    .num-block {
      width: 45px;
      height: 45px;
    }
    .num {
      font-size: 1.4rem;
    }
    .tagline {
      flex-direction: column;
      gap: 0.5rem;
    }
    .tag-line {
      display: none;
    }
  }
</style>
