---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import BlueskyFeed from '../components/BlueskyFeed.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 3);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<section class="text-center py-16 mb-12">
				<h1 class="hero-title text-6xl mb-4">[EIDOLWARE]</h1>
				<p class="text-xl text-cyber-gray-dark mb-8 max-w-3xl mx-auto">{SITE_DESCRIPTION}</p>
				<div class="flex gap-4 justify-center flex-wrap">
					<a href="https://fatbatstudio.itch.io/eidolware" target="_blank" rel="noopener noreferrer" class="group relative px-8 py-4 rounded-lg font-semibold uppercase tracking-widest transition-all duration-300 text-base bg-cyber-purple text-cyber-cyan border-2 border-cyber-purple overflow-hidden hover:shadow-glow-purple hover:-translate-y-0.5 hover:border-cyber-cyan">
						<span class="absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/50 to-transparent animate-[shine_3s_infinite]"></span>
						<span class="relative z-10">Follow on itch.io</span>
					</a>
					<a href="#" class="px-8 py-4 rounded-lg font-semibold uppercase tracking-widest transition-all duration-300 text-base bg-transparent text-[#66c0f4] border-2 border-[#1b2838] hover:shadow-[0_0_20px_rgba(102,192,244,0.2)] hover:-translate-y-0.5 hover:border-[#66c0f4] hover:bg-[#66c0f4]/5" title="Coming Soon">
						Steam Coming Soon
					</a>
					<a href="/blog" class="px-8 py-4 rounded-lg font-semibold uppercase tracking-widest transition-all duration-300 text-base bg-transparent text-cyber-cyan border-2 border-cyber-cyan hover:bg-cyber-cyan/10 hover:shadow-glow-cyan hover:-translate-y-0.5">
						Devlog
					</a>
				</div>
			</section>

			<section class="my-12 p-8 bg-black/50 border border-cyber-purple rounded-lg box-border">
				<h2 class="mt-0 text-3xl">About the Game</h2>
				<p class="text-lg leading-relaxed font-bold">
					Infiltrate a 24/7 anime convention where holograms are real, influencers reign supreme, and Otaku culture has gone completely off the rails in this satirical action-RPG by FATBAT Studio.
				</p>
				<p class="text-lg leading-relaxed">
					You are Anna Lam, a former AI engineer. The mysterious death of your mentor has led you to a newly established 24-hour anime convention, owned and operated by a crypto-billionaire who styles himself "Fedora Mask".
				</p>
				<p class="text-lg leading-relaxed">
					Immerse yourself in the convention and meet its strange denizens. Team up with unlikely allies to defeat Fedora Mask's lieutenants and gain access to the convention's inner circle. Uncover the truth behind your mentor's death and if anyone is responsible, put an end to their plans.
				</p>
			</section>

			<BlueskyFeed />

			{posts.length > 0 && (
				<section class="my-12">
					<div class="flex justify-between items-center mb-8 border-b-2 border-cyber-purple pb-4">
						<h2 class="m-0 text-3xl">Devlog</h2>
						<a href="/blog" class="text-sm uppercase tracking-widest font-semibold px-4 py-2 border border-cyber-cyan rounded transition-all duration-300 hover:bg-cyber-cyan/10 hover:shadow-glow-cyan">View all posts â†’</a>
					</div>
					<div class="grid grid-cols-[repeat(auto-fit,minmax(320px,1fr))] gap-8">
						{posts.map((post) => (
							<article class="p-6 bg-black/50 border border-cyber-purple rounded-lg transition-all duration-300 hover:border-cyber-cyan hover:shadow-[0_0_20px_rgba(177,255,236,0.2)] hover:-translate-y-0.5">
								<a href={`/blog/${post.id}/`} class="no-underline text-inherit">
									<h3 class="text-xl mb-2 text-cyber-cyan">{post.data.title}</h3>
									<time class="text-sm text-cyber-gray block mb-3">{post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}</time>
									<p class="text-cyber-gray-dark leading-relaxed m-0">{post.data.description}</p>
								</a>
							</article>
						))}
					</div>
				</section>
			)}
		</main>
		<Footer />
	</body>
</html>

<style>
	.hero-title {
		/* Use the standard h1 glow like on the character page */
		text-shadow: 0 0 10px rgba(177, 255, 236, 0.8), 0 0 20px rgba(177, 255, 236, 0.6), 0 0 30px rgba(177, 255, 236, 0.4);
	}

	@keyframes shine {
		0% { transform: translateX(0); }
		100% { transform: translateX(200%); }
	}

	@media (max-width: 720px) {
		.hero-title,
		.text-6xl {
			font-size: 2rem !important;
			margin-bottom: 0.75rem !important;
		}

		.text-xl {
			font-size: 1rem !important;
		}

		.flex.gap-4 {
			flex-direction: column !important;
			gap: 0.75rem !important;
		}

		.px-8.py-4 {
			width: 100% !important;
			max-width: 100% !important;
			padding: 0.875rem 1rem !important;
			font-size: 0.9rem !important;
			box-sizing: border-box !important;
		}

		section.p-8 {
			padding: 1.5rem 1rem !important;
			margin: 2rem 0 !important;
		}

		.flex.justify-between {
			flex-direction: column !important;
			align-items: flex-start !important;
			gap: 1rem !important;
		}

		.grid {
			grid-template-columns: 1fr !important;
		}
	}
</style>
